<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · AllenNeuropixels.jl</title><meta name="title" content="Home · AllenNeuropixels.jl"/><meta property="og:title" content="Home · AllenNeuropixels.jl"/><meta property="twitter:title" content="Home · AllenNeuropixels.jl"/><meta name="description" content="Documentation for AllenNeuropixels.jl."/><meta property="og:description" content="Documentation for AllenNeuropixels.jl."/><meta property="twitter:description" content="Documentation for AllenNeuropixels.jl."/><meta property="og:url" content="https://brendanjohnharris.github.io/AllenNeuropixels.jl/"/><meta property="twitter:url" content="https://brendanjohnharris.github.io/AllenNeuropixels.jl/"/><link rel="canonical" href="https://brendanjohnharris.github.io/AllenNeuropixels.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>AllenNeuropixels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li><li><a class="tocitem" href="allen_neuropixels/">AllenNeuropixels</a></li><li><a class="tocitem" href="allen_neuropixels_base/">AllenNeuropixelsBase</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/brendanjohnharris/AllenNeuropixels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/brendanjohnharris/AllenNeuropixels.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="AllenNeuropixels"><a class="docs-heading-anchor" href="#AllenNeuropixels">AllenNeuropixels</a><a id="AllenNeuropixels-1"></a><a class="docs-heading-anchor-permalink" href="#AllenNeuropixels" title="Permalink"></a></h1><p>AllenNeuropixels.jl is a Julia package for loading, analyzing, and visualizing data from the Allen Neuropixels mouse electrophysiology datasets (<a href="https://portal.brain-map.org/circuits-behavior/visual-coding-neuropixels">Visual Coding</a> and <a href="https://portal.brain-map.org/circuits-behavior/visual-behavior-neuropixels">Visual Behavior</a>).</p><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><ul><li>Load, filter, and partition LFP and spike-band data (see <a href="https://www.github.com/brendanjohnharris/AllenNeuropixelsBase.jl">AllenNeuropixelsBase.jl</a>)</li><li>Calculate channel and unit depths (along the probe length, or along atlas streamlines)</li><li>ICA, PCA, CCA, spectral (including FOOOF), wavelet, and burst-based analysis</li><li>Visualize spike rasters, wavelet spectrograms, burst masks, and 3D renders of the mouse reference atlas (including probe locations)</li></ul><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>Below we provide some basic examples for Visual Coding dataset.</p><h3 id="Installing-and-initializing"><a class="docs-heading-anchor" href="#Installing-and-initializing">Installing and initializing</a><a id="Installing-and-initializing-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-and-initializing" title="Permalink"></a></h3><p>To install AllenNeuropixels.jl and set a custom directory for data downloads (the default is a scratchspace):</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;AllenNeuropixels&quot;) # Please see the AllenSDK.jl readme for any python-related troubles
import AllenNeuropixels as AN
AN.setdatadir(&quot;~/Downloads/AllenNeuropixelsData/&quot;) # Then restart Julia</code></pre><h3 id="Listing-sessions"><a class="docs-heading-anchor" href="#Listing-sessions">Listing sessions</a><a id="Listing-sessions-1"></a><a class="docs-heading-anchor-permalink" href="#Listing-sessions" title="Permalink"></a></h3><p>The dataset is divided into recording sessions, each with a unique ID. Sessions last for about 3 hours and follow standardized stimulus templates. One mouse can have multiple recording sessions. To access the session table (containing metadata such as session id, session type, mouse age, genotype, etc.) and select a session by id:</p><pre><code class="language-julia hljs">seshtable = AN.getsessiontable() # Or AN.VisualBehavior.getsessiontable() for the Visual Behavior dataset
sessionid = seshtable[1, :id]
session = AN.Session(sessionid) # This can take a few moments</code></pre><p>An instance of the <code>AN.Session</code> type holds the python objects for a given session that interface with the <a href="https://github.com/AllenInstitute/AllenSDK">AllenSDK</a>.</p><h3 id="Querying-probes,-channels,-epochs,-and-stimuli"><a class="docs-heading-anchor" href="#Querying-probes,-channels,-epochs,-and-stimuli">Querying probes, channels, epochs, and stimuli</a><a id="Querying-probes,-channels,-epochs,-and-stimuli-1"></a><a class="docs-heading-anchor-permalink" href="#Querying-probes,-channels,-epochs,-and-stimuli" title="Permalink"></a></h3><p>The recording for each session are made synchronously across six probes, each with hundreds of channels. To retrieve the probe metadata, channel metadata, and stimulus metadata for a given <code>AN.Session</code>:</p><pre><code class="language-julia hljs">probes = AN.getprobes(session) # Can also be AN.getprobes() to list all probes in the Visual Coding dataset
channels = AN.getchannels(session) # Or AN.getchannels()
epochs = AN.getepochs(session) # A Dataframe of stimulus epoch metadata
stimuli = AN.getstimuli(session) # A Dataframe for individual stimulus presentations</code></pre><h3 id="Loading-LFP-data"><a class="docs-heading-anchor" href="#Loading-LFP-data">Loading LFP data</a><a id="Loading-LFP-data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-LFP-data" title="Permalink"></a></h3><p>To load the LFP data for a particular session, during a particular stimulus epoch (see <code>epochs.stimulus_name</code>), for channels in a particular brain region (structure; see <code>channels.ecephys_structure_acronym</code>):</p><pre><code class="language-julia hljs">LFP = AN.formatlfp(session; stimulus=&quot;flashes&quot;, structure=&quot;VISl&quot;)</code></pre><p>This will return a <a href="https://www.github.com/brendanjohnharris/TimeseriesTools.jl"><code>TimeSeries</code></a> containing LFP data with (rectified) timestamps and channel ids. The raw LFP (with original timestamps) can be accessed using <code>AN.getlfp</code>. To calculate depths for the LFP channels:</p><pre><code class="language-julia hljs">using TimeseriesTools
channelids = lookup(LFP, Chan)
probedepths = AN.getchanneldepths(session, channelids; method=:probe) # From the cortical surface along probe depths (μm)
streamlinedepths = AN.getchanneldepths(session, channelids; method=:streamlines) # Along streamlines (%)</code></pre><h3 id="Loading-spike-data"><a class="docs-heading-anchor" href="#Loading-spike-data">Loading spike data</a><a id="Loading-spike-data-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-spike-data" title="Permalink"></a></h3><p>To load a dictionary of spike times for a given session and structure, use:</p><pre><code class="language-julia hljs">spikes = AN.getspiketimes(session, &quot;VISl&quot;)
probeid = TimeseriesTools.metadata(LFP)[:probeid]
spikedepths = AN.getunitdepths(session, probeid, keys(spikes); method=:streamlines)</code></pre><p>These spikes trains can then be aligned to different stimuli using information from the metadata tables above.</p><h3 id="Plotting"><a class="docs-heading-anchor" href="#Plotting">Plotting</a><a id="Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting" title="Permalink"></a></h3><p>With <code>Makie</code> loaded, you can access the plotting utilites (<code>src/Plots/</code>). For example, you can plot the CCFv3 structure meshes with:</p><pre><code class="language-julia hljs">using CairoMakie
D = AN.getstructureidmap()
root = D[&quot;root&quot;] # The whole brain
VISl = D[&quot;VISl&quot;] # One structure

f = Figure(; size = (720, 560))
ax = Axis3(f[1, 1]; aspect = :data)
p = AN.Plots.plotbrainstructure!(ax, root; hemisphere=:both)
p = AN.Plots.plotbrainstructure!(ax, VISl; hemisphere=:both)
f</code></pre><p><img src="example1.png" alt="example_brain_plot"/> Or, for a more complete plot, with the Neuropixels probes:</p><pre><code class="language-julia hljs">f = Figure(; size = (720, 560))
ax = Axis3(f[1, 1]; aspect = :data)
p = AN.Plots.plotbrain!(ax, session; hemisphere=:both, dotext=false)
f</code></pre><p><img src="example2.png" alt="example_probe_plot"/></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="allen_neuropixels/">AllenNeuropixels »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 5 June 2025 00:35">Thursday 5 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
